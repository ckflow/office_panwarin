<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏™‡∏±‡πà‡∏á‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background-color: #f4f6f9; padding-bottom: 80px; font-family: 'Sarabun', sans-serif; }
        .product-card {
            background: white; border-radius: 15px; padding: 15px; margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); display: flex; align-items: center; justify-content: space-between;
        }
        .product-info { flex-grow: 1; }
        .product-name { font-weight: bold; font-size: 16px; color: #333; margin-bottom: 2px; }
        .product-desc { font-size: 12px; color: #888; }
        
        /* ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô */
        .counter-box { display: flex; align-items: center; background: #f1f3f5; border-radius: 20px; padding: 2px; }
        .btn-count {
            width: 32px; height: 32px; border-radius: 50%; border: none;
            display: flex; align-items: center; justify-content: center; font-weight: bold; cursor: pointer;
        }
        .btn-minus { background-color: transparent; color: #dc3545; }
        .btn-plus { background-color: #0d6efd; color: white; }
        .count-display { width: 35px; text-align: center; font-weight: bold; font-size: 16px; border: none; background: transparent; }

        /* ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á */
        .bottom-bar {
            position: fixed; bottom: 0; left: 0; right: 0; background: white;
            padding: 15px; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); text-align: center;
        }
        .btn-confirm { width: 100%; border-radius: 30px; padding: 12px; font-size: 18px; font-weight: bold; }
        
        .cat-title { font-size: 14px; color: #666; margin: 10px 0 5px 5px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="container mt-3">
        <h4 class="text-center mb-4">üßä ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</h4>

        <div class="cat-title">‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡∏´‡∏•‡∏≠‡∏î & ‡πÅ‡∏û‡πá‡∏Ñ</div>
        
        <div class="product-card">
            <div class="product-info">
                <div class="product-name">ü•§ ‡∏´‡∏•‡∏≠‡∏î‡πÉ‡∏´‡∏ç‡πà</div>
                <div class="product-desc">‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö‡∏•‡∏∞ 40 ‡∏ö‡∏≤‡∏ó</div>
            </div>
            <div class="counter-box">
                <button class="btn-count btn-minus" onclick="updateQty('tube_l', -1)"><i class="fas fa-minus"></i></button>
                <input type="text" id="qty_tube_l" value="0" class="count-display" readonly>
                <button class="btn-count btn-plus" onclick="updateQty('tube_l', 1)"><i class="fas fa-plus"></i></button>
            </div>
        </div>

        <div class="product-card">
            <div class="product-info">
                <div class="product-name">üßã ‡∏´‡∏•‡∏≠‡∏î‡πÄ‡∏•‡πá‡∏Å</div>
                <div class="product-desc">‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö‡∏•‡∏∞ 40 ‡∏ö‡∏≤‡∏ó</div>
            </div>
            <div class="counter-box">
                <button class="btn-count btn-minus" onclick="updateQty('tube_s', -1)"><i class="fas fa-minus"></i></button>
                <input type="text" id="qty_tube_s" value="0" class="count-display" readonly>
                <button class="btn-count btn-plus" onclick="updateQty('tube_s', 1)"><i class="fas fa-plus"></i></button>
            </div>
        </div>

        <div class="product-card">
            <div class="product-info">
                <div class="product-name">üì¶ ‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏û‡πá‡∏Ñ</div>
                <div class="product-desc">‡πÅ‡∏û‡πá‡∏Ñ‡∏•‡∏∞ 8 ‡∏ö‡∏≤‡∏ó</div>
            </div>
            <div class="counter-box">
                <button class="btn-count btn-minus" onclick="updateQty('pack', -1)"><i class="fas fa-minus"></i></button>
                <input type="text" id="qty_pack" value="0" class="count-display" readonly>
                <button class="btn-count btn-plus" onclick="updateQty('pack', 1)"><i class="fas fa-plus"></i></button>
            </div>
        </div>

        <div class="cat-title">‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡∏ö‡∏î</div>
        
        <div class="product-card">
            <div class="product-info">
                <div class="product-name">üçß ‡∏ö‡∏î‡∏´‡∏•‡∏≠‡∏î</div>
                <div class="product-desc">‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö‡∏•‡∏∞ 35 ‡∏ö‡∏≤‡∏ó</div>
            </div>
            <div class="counter-box">
                <button class="btn-count btn-minus" onclick="updateQty('crush_tube', -1)"><i class="fas fa-minus"></i></button>
                <input type="text" id="qty_crush_tube" value="0" class="count-display" readonly>
                <button class="btn-count btn-plus" onclick="updateQty('crush_tube', 1)"><i class="fas fa-plus"></i></button>
            </div>
        </div>
        
        <div class="product-card">
            <div class="product-info">
                <div class="product-name">‚ùÑÔ∏è ‡∏ö‡∏î‡∏Å‡πâ‡∏≠‡∏ô</div>
                <div class="product-desc">‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö‡∏•‡∏∞ 35 ‡∏ö‡∏≤‡∏ó</div>
            </div>
            <div class="counter-box">
                <button class="btn-count btn-minus" onclick="updateQty('crush_cube', -1)"><i class="fas fa-minus"></i></button>
                <input type="text" id="qty_crush_cube" value="0" class="count-display" readonly>
                <button class="btn-count btn-plus" onclick="updateQty('crush_cube', 1)"><i class="fas fa-plus"></i></button>
            </div>
        </div>

        <div class="cat-title">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ñ‡∏∏‡∏á</div>
        <div class="product-card">
            <div class="product-info">
                <div class="product-name">‚ôªÔ∏è ‡∏Ñ‡∏∑‡∏ô‡∏ñ‡∏∏‡∏á (‡πÉ‡∏ö)</div>
            </div>
            <div class="counter-box">
                <button class="btn-count btn-minus" onclick="updateQty('bag_return', -1)"><i class="fas fa-minus"></i></button>
                <input type="text" id="qty_bag_return" value="0" class="count-display" readonly>
                <button class="btn-count btn-plus" onclick="updateQty('bag_return', 1)"><i class="fas fa-plus"></i></button>
            </div>
        </div>

    </div>

    <div class="bottom-bar">
        <button class="btn btn-primary btn-confirm" onclick="submitOrder()">
            ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ <span id="total-items" style="display:none; background:white; color:#0d6efd; padding:0 8px; border-radius:10px; font-size:14px;">0</span>
        </button>
    </div>

    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script>
        // --- ‡πÉ‡∏™‡πà LIFF ID ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö ---
        const MY_LIFF_ID = "2008689090-CnrdxM5k"; 

        // ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Mapping ID ‡∏Å‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢)
        const products = {
            'tube_l': '‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡∏´‡∏•‡∏≠‡∏î‡πÉ‡∏´‡∏ç‡πà',
            'tube_s': '‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡∏´‡∏•‡∏≠‡∏î‡πÄ‡∏•‡πá‡∏Å',
            'pack': '‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏û‡πá‡∏Ñ',
            'crush_tube': '‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡∏ö‡∏î‡∏´‡∏•‡∏≠‡∏î',
            'crush_cube': '‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡∏ö‡∏î‡∏Å‡πâ‡∏≠‡∏ô',
            'bag_return': '‡∏Ñ‡∏∑‡∏ô‡∏ñ‡∏∏‡∏á'
        };

        async function main() {
            await liff.init({ liffId: MY_LIFF_ID });
            if (!liff.isLoggedIn()) { liff.login(); }
        }
        main();

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏•‡∏î ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
        function updateQty(id, change) {
            let el = document.getElementById('qty_' + id);
            let current = parseInt(el.value);
            let newVal = current + change;
            if (newVal < 0) newVal = 0;
            el.value = newVal;
            
            updateTotalBadge();
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏°
        function updateTotalBadge() {
            let total = 0;
            for (let key in products) {
                total += parseInt(document.getElementById('qty_' + key).value);
            }
            let badge = document.getElementById('total-items');
            if (total > 0) {
                badge.innerText = total;
                badge.style.display = 'inline-block';
            } else {
                badge.style.display = 'none';
            }
        }

        // ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
        async function submitOrder() {
            let orderLines = [];
            
            // ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î
            for (let key in products) {
                let qty = parseInt(document.getElementById('qty_' + key).value);
                if (qty > 0) {
                    // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: - ‡∏´‡∏•‡∏≠‡∏î‡πÉ‡∏´‡∏ç‡πà: 5 ‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö
                    let unit = (key === 'pack') ? '‡πÅ‡∏û‡πá‡∏Ñ' : (key === 'bag_return') ? '‡πÉ‡∏ö' : '‡∏Å‡∏£‡∏∞‡∏™‡∏≠‡∏ö';
                    orderLines.push(`- ${products[key]}: ${qty} ${unit}`);
                }
            }

            if (orderLines.length === 0) {
                alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏±‡∏ö");
                return;
            }

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡πà‡∏á
            let messageText = "üìã ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà‡∏Ñ‡∏£‡∏±‡∏ö\n" + orderLines.join("\n");

            try {
                if (!liff.isInClient()) {
                    alert("Order Summary:\n" + messageText);
                } else {
                    await liff.sendMessages([{ type: 'text', text: messageText }]);
                    liff.closeWindow();
                }
            } catch (err) {
                alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + err);
            }
        }
    </script>
</body>
</html>